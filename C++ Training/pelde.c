#include<stdio.h>

struct stack {
	int a[10001],top;
};
typedef struct stack STACK;
STACK stk;

int top(){ if(stk.top >= 0) return stk.a[stk.top];}
int pop(){ if(stk.top >= 0) return stk.a[stk.top--]; }
int empty(){ return (stk.top == -1 );}
void push(int val){ stk.a[++stk.top] = val;}

int findMaxLen(char *exp)
{
	int i = 0, result = 0;
   stk.top = -1;
   push(-1);
	for (;exp[i]!='\0'; i++)
	{
		if (exp[i] == '(' || exp[i] == '{' || exp[i] == '[' )
		   push(i);
		else 
		{
		   if(exp[i]==')' && exp[top()]=='(')
			   pop();
         else if(exp[i]=='}' && exp[top()]=='{')
			   pop();
            else if(exp[i]==']' && exp[top()]=='[')
			   pop();
         else if(top() != exp[i])
           while(!empty()) pop();
			if (!empty())
			   result = (result > (i - top()) )? result : (i - top());
			else push(i);
		}
	}
	return result;
}

int main()
{
	//char * exp = "{()}[][()][{}[][[]](()){}]}{}(){";
	//char * exp = "}{()}({([()}])}))))";

//	printf("%d <-- Answer\n",findMaxLen(exp));

	//exp = "()({([])})))){{{([";
	//exp = "})})}]";
char *	exp = "({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[(({[()[][{}()]]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]}))]})";
	printf("%d <-- Answer\n",findMaxLen(exp));

	return 0;
}

